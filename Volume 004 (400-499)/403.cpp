/* @JUDGE_ID: 19899RK 403 C++ "By Anadan" */ 
// Postscript
// Accepted (0.002 seconds with low memory spent)

#include <stdio.h>
#include <string.h>

int row, col;
char map[60][61], font[3];
const char c5[130][7] = {
".***..", "****..", ".****.", "****..", "*****.", "*****.", ".****.", "*...*.", "*****.", "..***.", "*...*.", "*.....", "*...*.", "*...*.", ".***..", "****..", ".***..", "****..", ".****.", "*****.", "*...*.", "*...*.", "*...*.", "*...*.", "*...*.", "*****.",
"*...*.", "*...*.", "*...*.", "*...*.", "*.....", "*.....", "*.....", "*...*.", "..*...", "...*..", "*..*..", "*.....", "**.**.", "**..*.", "*...*.", "*...*.", "*...*.", "*...*.", "*.....", "*.*.*.", "*...*.", "*...*.", "*...*.", ".*.*..", ".*.*..", "...*..",
"*****.", "****..", "*.....", "*...*.", "***...", "***...", "*..**.", "*****.", "..*...", "...*..", "***...", "*.....", "*.*.*.", "*.*.*.", "*...*.", "****..", "*...*.", "****..", ".***..", "..*...", "*...*.", ".*.*..", "*.*.*.", "..*...", "..*...", "..*...",
"*...*.", "*...*.", "*.....", "*...*.", "*.....", "*.....", "*...*.", "*...*.", "..*...", "*..*..", "*..*..", "*.....", "*...*.", "*..**.", "*...*.", "*.....", "*..**.", "*..*..", "....*.", "..*...", "*...*.", ".*.*..", "**.**.", ".*.*..", "..*...", ".*....",
"*...*.", "****..", ".****.", "****..", "*****.", "*.....", ".***..", "*...*.", "*****.", ".**...", "*...*.", "*****.", "*...*.", "*...*.", ".***..", "*.....", ".****.", "*...*.", "****..", ".***..", ".***..", "..*...", "*...*.", "*...*.", "..*...", "*****."
};

void outprintch(char c){
	int i, j, k;

	k = c - 'A';
	for (i = row; i < row + 5; ++i, k += 26){
		if (i < 0 || i >= 60) continue;
		for (j = col; j < col + 6; ++j){
			if (j < 0 || j >= 60) continue;
			if (c5[k][j - col] == '*') map[i][j] = '*';
		}
	}
}

void outprint(char *p){
	if (row >= 60) return;
	if (font[1] == '5'){
		while (*p){
			if (*p != ' ') outprintch(*p);
			++p; col += 6;
		}
	}else{
		if (row < 0) return;
		while (*p){
			if (0 <= col && col < 60 && *p != ' ') map[row][col] = *p;
			++p; ++col;
		}
	}
}

int main(){
	int i;
	char str[81], *p, *q;

	for (i = 0; i < 60; ++i) map[i][60] = 0;
	while (scanf("%s", str) == 1){
		for (i = 0; i < 60; ++i) memset(map[i], '.', 60);
		while (strcmp(str, ".EOP")){
			scanf("%s", font);

			i = str[1];
			scanf("%d", &row);
			if (i == 'P') scanf("%d", &col);
			else if (i == 'L') col = 1;

			p = gets(str);
			while (*p != '|') ++p;
			++p;
			q = p + strlen(p) - 1;
			while (*q != '|') --q;
			*q = 0;

			if (i == 'R'){
				i = strlen(p);
				if (font[1] == '5') i *= 6;
				col = 60 - i + 1;
			}else if (i == 'C'){
				i = strlen(p);
				if (font[1] == '5') i *= 6;
				col = 31 - i / 2;
			}

			--row; --col;
			outprint(p);
			scanf("%s", str);
		}

		for (i = 0; i < 60; ++i) printf("%s\n", map[i]);
		printf("\n------------------------------------------------------------\n\n");
	}

	return 0;
}
/* @END_OF_SOURCE_CODE */
